{% extends "store/base.html" %}
{% load static %}
{% block title %}Checkout - {% endblock title %}



{% block content %}

<section class="checkout">
    <div class="checkout-content">
        
        <div class="checkout-left-all">
            <div class="checkout-left" id='checkout-left'>
                <form id="form">
                    <div class="checkout-info" id="user-info">
                            <input required class="form-field" type="text" name="name" placeholder="Nome">
                            <input required class="form-field" type="email" name="email" placeholder="Email">
                    </div>
                    
                    <div class="checkout-shipping" id="shipping-info">
                        <h3> Informações de envio :</h3>
                            <input class="form-field" type="text" name="address" placeholder="Endereço">
                            <input class="form-field" type="text" name="city" placeholder="Cidade">
                            <input class="form-field" type="text" name="state" placeholder="Estado">
                            <input class="form-field" type="text" name="zipcode" placeholder="CEP">
                            <input class="form-field" type="text" name="country" placeholder="País">
                    </div>
    
                    <input id="form-button" class="form-button" type="submit" value="Continuar">
                </form>
                
            </div>
            <div class="payment-info hidden" id="payment-info">
                <small>Paypal Options</small>
                <!--<button id="make-payment">Make payment</button>-->
                <div id="paypal-button-container"></div>
            </div>
        </div>

        <div class="checkout-right">
            <div class="checkout-right-infos1">
                <h3>
                    
                    <a href="{% url 'store:cart' %}">
                        <i class="bi bi-arrow-left-short"></i>
                        Voltar ao carrinho
                    </a>
                    
                </h3>
            </div>

            <div class="checkout-right-infos2">
                <hr>
                <h1>
                    Detalhes do pedido
                </h1>
            </div>

            <div class="checkout-right-infos3">
                <table>
                    <tr class="tablehead">

                        <td>
                            Produto
                        </td>
                        <td>
                            Nome
                        </td>
                        <td>
                            Preço unid.
                        </td>
                        <td>
                            Quantidade
                        </td>
                        <td>
                            Valor
                        </td>

                    </tr>
                    {% for item in items %}
                    <tr class="tablebody">
                        
                            {% if item.produto.foto.url %}

                                        <td><img src="{{item.produto.foto.url}}" alt="Item 1"></td>

                                    {% else %}

                                        <td><img src="{% static 'caminho_da_foto1.jpg' %}" alt="Item 1"></td>

                                    {% endif %}
                                    <td>{{item.produto.nome}}</td>
                                    <td>{{item.produto.price|floatformat:2}}</td>
                                    <td>{{item.quantidade}}</td>
                                    <td>R$ {{item.get_total|floatformat:2}}</td>
                        
                    </tr>
                    {% endfor %}
                </table>

            </div>

            <div class="checkout-right-infos4">
                <hr>
                Total : R$ {{pedido.get_cart_total|floatformat:2}}
            </div>
        </div>

    </div>
</section>
<script>
    var shipping = '{{pedido.shipping}}';

    if (shipping === 'False') {
        var shippingInfo = document.getElementById('shipping-info');
        shippingInfo.innerHTML = 'No momento não é necessário preencher informações de envio !';
        shippingInfo.style.textAlign = 'center';
        shippingInfo.style.fontSize = '34px';

        
        var checkoutLeftForm = document.querySelector('.checkout-left form');
        if (checkoutLeftForm) {
            checkoutLeftForm.style.display = 'flex';
            checkoutLeftForm.style.justifyContent = 'space-evenly';
        }
    }

    var form = document.getElementById('form')
    form.addEventListener('submit', function(e){
        e.preventDefault()
        console.log('Form enviado')
        document.getElementById('form-button').classList.toggle('hidden');
        document.getElementById('payment-info').classList.toggle('hidden');

    
    })


</script>



{% endblock content %}